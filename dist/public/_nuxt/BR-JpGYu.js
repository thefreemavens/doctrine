import{bt as H,bu as U,w as N,bv as j,G as F,H as G,bw as T,bx as k,d as O,o as w,a as E,p as v,q as V,m as $,s,W as M,by as X,bz as Z,c as z,$ as Q,ae as A,av as J,e as L,B as g,bA as K,F as Y,v as ee,bB as R,bC as te,bD as I,bE as ne,a5 as q,f as D,a8 as W,bF as oe,bG as ae,aQ as ie,bH as se,bI as le}from"./w1hxH6Fm.js";let re=0;function ue(n){const t=new WeakMap,u=H();function C(a){if(n.mode!=="popLayout")return;const c=a.offsetParent,d=c instanceof HTMLElement&&c.offsetWidth||0,l={height:a.offsetHeight||0,width:a.offsetWidth||0,top:a.offsetTop,left:a.offsetLeft,right:0};l.right=d-l.width-l.left;const p=n.anchorX==="left"?`left: ${l.left}px`:`right: ${l.right}px`,b=`pop-${re++}`;a.dataset.motionPopId=b;const r=document.createElement("style");u.value.nonce&&(r.nonce=u.value.nonce),t.set(a,r),document.head.appendChild(r),r.sheet&&r.sheet.insertRule(`
    [data-motion-pop-id="${b}"] {
      position: absolute !important;
      width: ${l.width}px !important;
      height: ${l.height}px !important;
      top: ${l.top}px !important;
      ${p} !important;
      }
      `)}function y(a){const c=t.get(a);c&&(t.delete(a),U.render(()=>{document.head.removeChild(c)}))}return{addPopStyle:C,removePopStyle:y}}function ce(n){const t=new Map,u=new Set,{addPopStyle:C,removePopStyle:y}=ue(n);function a(e,i){let o=t.get(e);o||(o={motions:new Set,exitingMotions:new Set,el:e},t.set(e,o)),o.motions.add(i)}function c(e,i){const o=t.get(e);o&&(o.exitingMotions.delete(i),o.exitingMotions.size===0&&o.done&&r(o))}function d(e){u.add(e)}function l(e){u.delete(e)}const p={initial:n.initial,custom:n.custom,register:a,onMotionExitComplete:c,registerPending:d,unregisterPending:l};N(()=>n.custom,e=>{p.custom=e},{flush:"pre"}),j(p),F(()=>{p.initial=void 0});function b(e){if(e instanceof HTMLElement&&!e.hasAttribute(k)){e.setAttribute(k,"");const i=T.get(e);i&&!i.presenceContainer&&(i.presenceContainer=e,a(e,i))}}function r(e){var i,o,h,P,f;y(e.el),(i=e.done)==null||i.call(e),e.done=void 0,(o=e.el)!=null&&o.isConnected?(P=(h=e.motions.values().next())==null?void 0:h.value)==null||P.didUpdate():(e.motions.forEach(x=>{x.unmount()}),e.motions.clear()),(f=n.onExitComplete)==null||f.call(n)}function S(e,i){b(e);const o=t.get(e);o&&(o.exitingMotions.clear(),o.motions.forEach(h=>{h.setActive("exit",!1),h.getSnapshot(h.options,!0)})),i()}function _(e,i){var o,h,P;const f=e;b(f),u.forEach(m=>{m.element&&f.contains(m.element)&&(m.presenceContainer=f,a(f,m),u.delete(m))});const x=t.get(f),B=T.get(f);if((!x||x.motions.size===0)&&!B){i(),(o=n.onExitComplete)==null||o.call(n);return}x.done=i,C(f),x.motions.forEach(m=>{x.exitingMotions.add(m),m.setActive("exit",!0),m.getSnapshot(m.options,!1)}),(P=(h=x.motions.values().next())==null?void 0:h.value)==null||P.didUpdate()}return G(()=>{t.forEach(e=>{e.motions.forEach(i=>{i.unmount()})}),t.clear()}),{enter:S,exit:_}}const de=O({name:"AnimatePresence",inheritAttrs:!0,__name:"AnimatePresence",props:{mode:{default:"sync"},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:"left"}},setup(n){const t=n,{enter:u,exit:C}=ce(t),y=z(()=>t.mode!=="wait"?{tag:t.as}:{mode:t.mode==="wait"?"out-in":void 0});return(a,c)=>(w(),E(M(a.mode==="wait"?X:Z),$(y.value,{appear:"",onLeave:s(C),onEnter:s(u)}),{default:v(()=>[V(a.$slots,"default")]),_:3},16,["onLeave","onEnter"]))}}),fe={slots:{base:"rounded-md w-full",overlay:"fixed inset-0 bg-default/75 backdrop-blur-sm will-change-opacity",content:"fixed inset-0 flex items-center justify-center cursor-zoom-out focus:outline-none",zoomedImage:"w-full h-auto max-w-[95vw] max-h-[95vh] object-contain rounded-md"},variants:{zoom:{true:"will-change-transform"},open:{true:""}},compoundVariants:[{zoom:!0,open:!1,class:"cursor-zoom-in"}]},me=["onClick"],he=Object.assign({inheritAttrs:!1},{__name:"ProseImg",props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},class:{type:null,required:!1},zoom:{type:Boolean,required:!1,default:!0},ui:{type:null,required:!1}},setup(n){const t=n,u=Q(),[C,y]=A(),[a,c]=A(),d=ee(!1),l=z(()=>W({extend:W(fe),...u.ui?.prose?.img||{}})({zoom:t.zoom,open:d.value})),p=z(()=>{if(t.src?.startsWith("/")&&!t.src.startsWith("//")){const r=oe(ae(ie().app.baseURL));if(r!=="/"&&!t.src.startsWith(r))return se(r,t.src)}return t.src}),b=z(()=>`${p.value}::${le()}`);return t.zoom&&J(window,"scroll",()=>{d.value=!1}),(r,S)=>(w(),L(Y,null,[g(s(C),null,{default:v(()=>[(w(),E(M(s(R)),$({src:p.value,alt:n.alt,width:n.width,height:n.height},r.$attrs,{class:l.value.base({class:[t.ui?.base,t.class]})}),null,16,["src","alt","width","height","class"]))]),_:1}),g(s(a),null,{default:v(()=>[(w(),E(M(s(R)),$({src:p.value,alt:n.alt},r.$attrs,{class:l.value.zoomedImage({class:[t.ui?.zoomedImage]})}),null,16,["src","alt","class"]))]),_:1}),n.zoom?(w(),E(s(K),{key:0,open:d.value,"onUpdate:open":S[0]||(S[0]=_=>d.value=_),modal:!1},{default:v(({close:_})=>[g(s(te),{"as-child":""},{default:v(()=>[g(s(I),{"layout-id":b.value,"as-child":"",transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:v(()=>[g(s(y))]),_:1},8,["layout-id"])]),_:1}),g(s(ne),null,{default:v(()=>[g(s(de),null,{default:v(()=>[d.value?(w(),E(s(I),{key:0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},class:q(l.value.overlay({class:[t.ui?.overlay]}))},null,8,["class"])):D("",!0),d.value?(w(),L("div",{key:1,class:q(l.value.content({class:[t.ui?.content]})),onClick:_},[g(s(I),{"as-child":"","layout-id":b.value,transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:v(()=>[g(s(c))]),_:1},8,["layout-id"])],10,me)):D("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["open"])):(w(),E(s(y),{key:1}))],64))}});export{he as default};
